<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rodent Riddle</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="game.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="apple-touch-icon" sizes="180x180" href="image/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="image/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="image/favicon/favicon-16x16.png">
    <link rel="manifest" href="image/favicon/site.webmanifest">
    <script src="main.js" type="module"></script>
    <script>
        function toggleAnswer(button) {
            const answer = button.nextElementSibling;
            if (answer.style.display === 'none') {
                answer.style.display = 'block';
                button.textContent = 'Hide our suggested answer';
            } else {
                answer.style.display = 'none';
                button.textContent = 'Show our suggested answer';
            }
        }
    </script>
</head>

<body>
    <div class="main-header">
        <h1 class="main-title">
            <span class="rodent-text">Rodent</span>
            <span class="riddle-text">Riddle</span>
        </h1>
        <div style="text-align: center;">
            <p class="main-subtitle">Inferring internal states from external behavior</p>
        </div>
    </div>

    <p>
        You might think that we can't know much about a mouse only from its temperature and activity level, but you'd be surprised!
        Let's practice learning from data by analyzing a few graphs: 
    </p>

    <h2>
        When do mice sleep?
    </h2>

    <h3>Activity Patterns Throughout the Day</h3>
    <p class="viz-instructions">
        When are mice most active? These pie charts reveal the distribution of mouse activity during light-on (day) and light-off (night) periods.
        Compare the overall activity patterns with those of male and female mice separately to discover behavioral insights.
    </p>
    <ul class="viz-features">
        <li><strong>Overall Activity Distribution:</strong> The left chart shows total activity across all mice, revealing the proportion of time spent active during day versus night periods.</li>
        <li><strong>Gender-Based Comparison:</strong> The right charts break down activity patterns by sex, allowing you to identify whether male and female mice exhibit different circadian behaviors.</li>
        <li><strong>Color Legend:</strong> Blue represents light-off periods (night), while yellow represents light-on periods (day).</li>
        <li><strong>Interactive Elements:</strong> Hover over chart segments to see exact percentages and compare values across different groups.</li>
    </ul>
    <div id="activity_overall">
        <!-- Visualization will be dynamically added here (other-file.js) -->
    </div>
    <p class="viz-questions">
        <strong>Questions to consider:</strong> What does the size of each slice tell you about when mice are most active? 
        Do you notice any significant differences between male and female activity patterns? What might this reveal about mouse circadian rhythms?
    </p>
    <button class="show-answer-btn" onclick="toggleAnswer(this)">Show our suggested answer</button>
    <p class="viz-answer" style="display: none;">
        <strong>Our suggested answer:</strong> The visualization clearly reveals that approximately three-quarters (75%) of mouse activity occurs during light-off periods (night), 
        demonstrating strong nocturnal behavior. This aligns with mice being naturally nocturnal animals who are most active when it's dark. 
        Importantly, when comparing male and female mice, we observe remarkably similar activity distributions—both sexes show nearly identical 
        proportions of day versus night activity. This suggests that circadian rhythm patterns are consistent across sexes in mice, 
        with both male and female mice exhibiting the same strong preference for nighttime activity. The small variations between sexes 
        (within 1-2%) are likely within normal biological variation rather than indicating meaningful behavioral differences.
    </p>

    <!-- Circadian Rhythm -->
    <h3>Circadian Rhythm</h3>
    <p class="viz-instructions">
        This visualization shows mouse movement patterns and body temperature over multiple day/night cycles. The main
        plot (left) displays mouse positions and their movement (more active movement represent higher activity levels),
        while the right plot shows the relationship between temperature and activity levels. The color of each point
        represents the body temperature of the mouse.
    </p>
    <ul class="viz-features">
        <li><strong>Mouse Movement:</strong> Each point represents a mouse, with colors indicating body temperature
            (blue: cooler, red: warmer).</li>
        <li><strong>Day/Night Cycles:</strong> Background changes indicate light conditions, with the status shown in
            the top-right corner.</li>
        <li><strong>Interactive Features:</strong>
            <ul>
                <li>Hover over any point to see detailed mouse data and highlight the same mouse in both plots</li>
                <li>Hover pauses the animation automatically</li>
                <li>Use the time slider to navigate through the data</li>
                <li>Play/Pause and Reset buttons control the animation</li>
            </ul>
        </li>
        <li><strong>Temperature Scale:</strong> The color bar below the main plot shows the temperature range from 35°C
            (blue) to 39°C (red).</li>
    </ul>
    <div id="circadian-viz">
        <!-- Visualization will be dynamically added here (circadian.js) -->
    </div>
    <p class="viz-questions">
        <strong>Question to consider:</strong> How do the activity patterns of these mice across day and night cycles
        reveal their natural circadian rhythm?
    </p>
    <button class="show-answer-btn" onclick="toggleAnswer(this)">Show our suggested answer</button>
    <p class="viz-answer" style="display: none;">
        <strong>Our suggested answer:</strong> The visualization reveals clear circadian patterns in mouse behavior.
        During light-off periods (night), mice consistently show heightened activity levels, coupled with elevated body
        temperatures (shown by warmer colors). Conversely, during light-on periods (day), their activity decreases
        significantly, and body temperatures tend to be cooler. This day-night activity pattern strongly indicates
        nocturnal behavior, which is an evolutionary adaptation common in rodents. The synchronization between activity
        levels and body temperature also demonstrates how circadian rhythms coordinate multiple physiological processes
        to optimize survival during their most active periods.
    </p>

    <h2>
        Can We Guess the Gender of a Mouse?
    </h2>

    <!-- Hourly Average Temperatures By Gender -->
    <h3>Do Male and Female Mice Have the Same Temperatures?</h3>
    <p class="viz-instructions">
        If we can find that the average temperature of male and female mice differ by a large amount, then we should be
        able to
        reasonably guess the gender of a mouse based on its temperature.
    </p>
    <ul class="viz-features">
        <li><strong>Average Mouse Temperature:</strong> For each mouse, take its average temperature at an hour. Then,
            take the average of those average temperatures across each gender.</li>
        <li><strong>Hovering</strong> Hover over each line to see the 25th and 75th percentile of average hourly male or
            female mouse temperatures!</li>
        </li>
    </ul>
    <div id="hourly-temps">
        <!-- Visualization will be dynamically added here (your-file.js) -->
    </div>
    <p class="viz-questions">
        <strong>Question to consider:</strong> Can we guess mouse gender based on temperature and time? Will our guess
        always be correct?.
    </p>
    <button class="show-answer-btn" onclick="toggleAnswer(this)">Show our suggested answer</button>
    <p class="viz-answer" style="display: none;">
        <strong>Our suggested answer:</strong> The temperature feature is useful in predicting mouse gender, since
        females tend to be hotter at each hour of the day.
        Still, after checking percentiles, it's clear that the hottest male mice are often hotter than the coldest male
        mice, meaning that there is no
        perfect value that separates the genders.
    </p>

    <!-- Activity Ranking Visualization -->
    <h3>Activity Rankings: Gender Comparison</h3>
    <p class="viz-instructions">
        This visualization provides a comprehensive view of mouse activity patterns across day and night cycles, with a
        special focus on gender differences. The dual bar charts show activity levels during light-off (night) and
        light-on (day) periods, with mice automatically sorted by their activity levels. The visualization includes
        mini-plots showing the proportion of male vs female activity over time, allowing for detailed analysis of
        gender-based activity patterns.
    </p>
    <ul class="viz-features">
        <li><strong>Dual Bar Charts:</strong> Upper bars (light off) and lower bars (light on) show activity levels,
            with mice ranked by activity at each time point.</li>
        <li><strong>Gender Analysis:</strong> Blue bars represent male mice, pink bars represent female mice, with
            mini-plots showing the proportion of activity by gender over time.</li>
        <li><strong>Dynamic Features:</strong>
            <ul>
                <li>Real-time activity ranking updates as you move through time</li>
                <li>Running average rankings show consistent activity patterns</li>
                <li>Hover over bars to see detailed mouse information and highlight corresponding bars across all plots
                </li>
                <li>Mini-plots reveal gender activity proportions throughout the cycle</li>
            </ul>
        </li>
        <li><strong>Interactive Controls:</strong>
            <ul>
                <li>Time slider to navigate through a 12-hour cycle (720 minutes)</li>
                <li>Day selector to compare activity patterns across different days</li>
                <li>Play/Pause animation to observe activity changes over time</li>
            </ul>
        </li>
    </ul>
    <div id="activity-rank-viz">
        <!-- Visualization will be dynamically added here (activity_rank.js) -->
    </div>
    <p class="viz-questions">
        <strong>Question to consider:</strong> How do the activity levels of male and female mice compare during
        different periods of the day, and what changes do we observe in female activity patterns during estrus days?
    </p>
    <button class="show-answer-btn" onclick="toggleAnswer(this)">Show our suggested answer</button>
    <p class="viz-answer" style="display: none;">
        <strong>Our suggested answer:</strong> The visualization reveals interesting patterns in gender-based activity
        levels. Overall, male mice tend to show higher activity levels compared to female mice across both day and night
        periods. However, during estrus days, we observe a notable increase in female activity levels that extends
        beyond just the night period. While this increased activity doesn't surpass the overall male activity levels, it
        represents a significant behavioral change in female mice during their reproductive cycle. The mini-plots
        showing gender activity proportions help visualize these patterns, with the male proportion typically being
        higher but showing interesting variations during estrus periods. These findings suggest that while male mice
        maintain generally higher activity levels, female activity patterns are more dynamic and influenced by their
        reproductive state.
    </p>

    <h2>
        Can We Tell if a Female Mouse is in Estrus?
    </h2>

    <!-- Estrus temperature line graph -->
    <h3>Effect of Estrus</h3>
    <p class="viz-instructions">
        This visualization shows the differences in body temperature and activity levels of female mice depending on the
        estrus period. The line chart shows the average body temperature of 12 female mice. Hovering reveals the activity level
        at each time point.
    </p>
    <ul class="viz-features">
        <li><strong>Mouse Temperature:</strong> Each line represents the average mouse temperature change over one day for each
            period.<br>(red: estrus day, blue: 1 day before estrus day, green: 1 day after estrus day, purple: 2 days after
            estrus day)</li>
        <li><strong>Day/Night Cycles:</strong> Background changes indicate light conditions.</li>
        <li><strong>Interactive Features:</strong>
            <ul>
                <li>Hover over any point to zoom in on the graph and move cursor away to restore the graph.</li>
                <li>Hover over any point to see detailed mouse activity data for that point</li>
                <li>Activity data is sorted in descending order</li>
            </ul>
        </li>
        <li><strong>Data Sorting:</strong> Each line represents the average temperature of 12 female mice on designated days as
            follows:
            <ul>
                <li><strong>Estrus Day:</strong> Average of Day 2, Day 6, Day 10, and Day 14</li>
                <li><strong>1 Day Before Estrus Day:</strong> Average of Day 1, Day 5, Day 9, and Day 13</li>
                <li><strong>1 Day After Estrus Day:</strong> Average of Day 3, Day 7, Day 11</li>
                <li><strong>2 Days After Estrus Day:</strong> Average of Day 4, Day 8, Day 12</li>
            </ul>
        </li>
    </ul>
    <div id="other-viz">
        <!-- Visualization will be dynamically added here (other-file.js) -->
    </div>
    <p class="viz-questions">
        <strong>Question to consider:</strong> How does the estrus cycle affect female mouse body temperature and
        activity levels, and why?
    </p>
    <button class="show-answer-btn" onclick="toggleAnswer(this)">Show our suggested answer</button>
    <p class="viz-answer" style="display: none;">
        <strong>Our suggested answer:</strong> The visualization reveals that estrus affects mouse temperature starting
        around 4 hours (240 minutes) after the light is turned off (night starts) and ends around 5 hours (300
        minutes) after the light is turned on (day starts). During that period, the average temperature is 0.6°C higher
        than in other periods at maximum, which is quite significant considering that mice are homeothermic. Regarding
        activity levels, estrus also increases activity, but the affected duration is slightly different from body
        temperature changes. Around the same time body temperature increases, activity levels also increase, but they return to baseline around
        1 hour after the light is turned on (day starts), which is earlier than the body temperature increase. Hence, we can
        conclude that estrus causes female mice to move considerably more to find male mice for breeding, which is one factor that increases body
        temperature. In addition, estrogen levels increase significantly during estrus. This leads to stimulation of the
        hypothalamus and thermoregulatory centers, which can raise the set point for body temperature and increase the
        basal metabolic rate (BMR), resulting in more internal heat production.
        Beyond the estrus day itself, we can observe that mice one day before estrus have higher body temperature and activity
        levels compared to other periods. This occurs because female mice begin to prepare for estrus. As we can see, estrus
        increases mouse body temperature and activity levels most significantly on the estrus day, but these changes begin one day before as well.
    </p>

    <h2>
        Test Your Knowledge!
    </h2>
    <!-- Mice Data Interactive Game -->
    <h3>Interactive Mouse Behavior Game</h3>
    <p class="viz-instructions">
        Think you understand mouse behavior? Test your scientific intuition! This interactive game challenges you to
        determine a mouse's sex and reproductive state (estrus) based solely on temperature and activity data. Just like
        real researchers, you'll need to identify patterns in physiological data to make accurate inferences about the
        internal states of laboratory animals.
    </p>

    <div id="game-section" class="themed-game-section">
        <div id="start-overlay" class="start-overlay themed-start-overlay">
            <div class="start-content" style="justify-content: center;">
                <h2 class="highlight-title">Mice Data Interactive</h2>
                <img src="./image/mouse.gif" alt="Mouse GIF" class="mouse-gif" />
                <button id="start-btn">Start Game</button>
            </div>
        </div>

        <div class="main-flex" style="position: relative; z-index: 1;">
            <div class="container mouse-bg" style="display: none;">
                <h2 class="highlight-title center-heading">Mice Data Interactive</h2>
                <p class="game-explanation">
                    Eight mice, one mystery! Find the glowing mouse and guess its sex and estrus state. Can you crack
                    the code from the clues?
                </p>

                <div class="granularity-control">
                    <label for="granularity-select">Time Granularity: </label>
                    <select id="granularity-select">
                        <option value="day">Day</option>
                        <option value="halfday">Halfday</option>
                        <option value="hour" selected>Hour</option>
                        <option value="minute">Minute</option>
                    </select>
                </div>

                <div class="graphs-and-legend">
                    <div class="graph-section">
                        <div id="graph1"></div>
                        <div id="graph2" style="display: none;"></div>
                    </div>
                    <div id="legend-container"></div>
                </div>

                <div id="sex-guess" class="button-group">
                    <div class="buttons-row">
                        <button id="guess-male">Guess: Male</button>
                        <button id="guess-female">Guess: Female</button>
                    </div>
                    <span id="sex-result"></span>
                </div>

                <div id="estrus-guess" class="button-group" style="display: none;">
                    <div class="buttons-row">
                        <button id="estrus-yes">Guess: Estrus</button>
                        <button id="estrus-no">Guess: Not Estrus</button>
                    </div>
                    <span id="result"></span>
                </div>

                <div id="final-explanation" class="final-explanation" style="display: none; opacity: 0;">
                    <h3>Result</h3>
                    <div id="final-result"></div>
                    <button onclick="location.reload(); return false;" class="play-again-btn">Play Again</button>
                </div>
            </div>
        </div>

        <script type="module" src="game.js"></script>
    </div>

    <p>
        Data is a powerful tool if you can learn how to plot it! Only using two attributes about mice,
        by creating interactive visualization, we were able to learn about their sleeping patterns, gender, and internal states. 
        With a few more features, imagine what else we can discover. 
    </p>

</body>

</html>